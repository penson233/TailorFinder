from openpyxl import Workbook
#fofa
FOFA_EMAIL = "1524058207@qq.com"
FOFA_KEY = "3bdca7937a7b500d9d88de05ddd65f5c"


#hunter
hunter_key="e1d62ba4cba56ecd08146f7b145f1d8ca3d41f0ec37bf6bb45ff7581053100f5"
hunter_name="185******57"


#天眼查
tyccookie="TYCID=41bda4d0549211ee96146793e725899d; ssuid=1982732686; _ga=GA1.2.452956420.1698832357; CUID=39f26257778e24d9000a079ea5b24dd6; jsid=SEO-BAIDU-ALL-SY-000001; bdHomeCount=0; HWWAFSESID=706c322ce19c9b2b13e; HWWAFSESTIME=1718766923114; csrfToken=9oJi6OCDcTCD9Iku4AgmlJFf; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22232159298%22%2C%22first_id%22%3A%2218a9e1c4284878-03452e00b3cc07-18525634-1930176-18a9e1c42859fd%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22identities%22%3A%22eyIkaWRlbnRpdHlfY29va2llX2lkIjoiMThhOWUxYzQyODQ4NzgtMDM0NTJlMDBiM2NjMDctMTg1MjU2MzQtMTkzMDE3Ni0xOGE5ZTFjNDI4NTlmZCIsIiRpZGVudGl0eV9sb2dpbl9pZCI6IjIzMjE1OTI5OCJ9%22%2C%22history_login_id%22%3A%7B%22name%22%3A%22%24identity_login_id%22%2C%22value%22%3A%22232159298%22%7D%2C%22%24device_id%22%3A%2218a9e1c4284878-03452e00b3cc07-18525634-1930176-18a9e1c42859fd%22%7D; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1718676134,1718766931; _gid=GA1.2.510901302.1718767351; tyc-user-info=%7B%22state%22%3A%220%22%2C%22vipManager%22%3A%220%22%2C%22mobile%22%3A%2218574725457%22%2C%22userId%22%3A%22232159298%22%7D; tyc-user-info-save-time=1718767376036; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODU3NDcyNTQ1NyIsImlhdCI6MTcxODc2NzM3NSwiZXhwIjoxNzIxMzU5Mzc1fQ.e7VJNfKu9Q8puWXwixXgkARCovh3zxdRCbaZ9XMN-FTG7vq7Pb1Jv9U1DPt6rhUXhYfb2cf6I-B1LvQrg1OVjw; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1718767533; searchSessionId=1718767537.60004569"
tyctoken="eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODU3NDcyNTQ1NyIsImlhdCI6MTcxODc2NzM3NSwiZXhwIjoxNzIxMzU5Mzc1fQ.e7VJNfKu9Q8puWXwixXgkARCovh3zxdRCbaZ9XMN-FTG7vq7Pb1Jv9U1DPt6rhUXhYfb2cf6I-B1LvQrg1OVjw"
tycID="41bda4d0549211ee96146793e725899d"
#veryvp http://veryvp.com/
veryvpcookie=""
#爱奇查
aqccookie='BAIDUID=0695C38DF796E6CA398FFE3CED64D084:FG=1; PSTM=1696498122; BIDUPSID=6157C7A118093B7935BE77B68171F4EA; BDUSS=o3REZ6VVZNenhFLWR2OTk1Y2puSmRkaloyVVYwa2ZNVWM2clh0fnJBbzRoTWhsSVFBQUFBJCQAAAAAAAAAAAEAAADlEM18use6x9~Vd2RyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADj3oGU496Blam; BDUSS_BFESS=o3REZ6VVZNenhFLWR2OTk1Y2puSmRkaloyVVYwa2ZNVWM2clh0fnJBbzRoTWhsSVFBQUFBJCQAAAAAAAAAAAEAAADlEM18use6x9~Vd2RyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADj3oGU496Blam; H_WISE_SIDS=40155_39996_40008_40202_40207_40212_40215_40224; H_WISE_SIDS_BFESS=40155_39996_40008_40202_40207_40212_40215_40224; BAIDUID_BFESS=0695C38DF796E6CA398FFE3CED64D084:FG=1; H_PS_PSSID=40008_40207_40212_40215_40224_40272_40294_40291_40288_40284_40317_40080_40351_40381_40369_40358_40336; PSINO=7; BA_HECTOR=04al0l818g2481058h0k8g8g7lhv4v1iurf5j1t; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; ZFY=DMocMut8:AYok6XwlV4kN9yZ3pKmibBT94cWEXazYcqI:C; ab_sr=1.0.1_ZmE1OGJjYzMwYmFlMmY0NWExYjlmNTQ0MjQ2ZjUxZjQyOTc2NmQ0MzZiZTE2MWY0ZGMzZjMyNzI0NTg0ODQxZWQ1NDNkZDYyMzYzMjBhY2JlZDQ2MDJhNzgyZjI0ZGQ0MDcwYjgxMmE2NTFhN2YxMjcwNThhMDZiZDNiMmRjZjZkNGYyNmVhNWM0MDE3MTk1YzAyZDRlZGVkMmYwOTUxZA==; log_first_time=1710079922183; RT="z=1&dm=baidu.com&si=690d3a09-d953-4589-bf57-5309b868eca9&ss=ltllfk08&sl=0&tt=0&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf"; log_last_time=1710079925186'

#securitytrails
securitykey="PwcdPvdMcgb2IVK4QYFOEg3gXQ2nBmMj"

#https://hunter.io
hunteremailkey="559e9278d6b9cc6dd477d92448d5bb71fb82be18"


##设置持续话收集邮箱

emailaccount = ""
emailpassword = ""
emailtarget=['']
mailhost=""


wb = Workbook()

wb.create_sheet("domain",0)
wb.create_sheet("company_structs",1)
wb.create_sheet("旗下app",2)
wb.create_sheet("email",3)
wb.create_sheet("subfinder", 4)
wb.create_sheet("fofa", 5)
wb.create_sheet("hunter",6)
wb.create_sheet("crt.sh",7)
wb.create_sheet("assetfinder",8)
wb.create_sheet("shuffledns",9)
wb.create_sheet("securitytrails", 10)
wb.create_sheet("rappidns",11)
wb.create_sheet("ip138",12)
wb.create_sheet("alldomain",13)



rootdomain=wb["domain"]
emailwb=wb["email"]
appwb=wb["旗下app"]
subfinderwb = wb["subfinder"]
fofawb=wb["fofa"]
hunterwb=wb["hunter"]
crtwb=wb["crt.sh"]
ctwb=wb["company_structs"]
assetfinderwb=wb["assetfinder"]
alldomainwb=wb["alldomain"]
shufflednswb=wb["shuffledns"]
securitytrailswb=wb["securitytrails"]
rappidnswb=wb["rappidns"]
ip138wb=wb["ip138"]

hunterwb.append(['IP', '端口', '域名', 'IP标签', 'url', '网站标题', '高危协议', '协议', '通讯协议', '网站状态码', '应用/组件', '操作系统', '备案单位', '备案号', '备案异常', '资产标签', '国家', '省份', '市区', '探查时间', 'Web资产', '运营商', '注册机构', '证书SHA256'])
fofawb.append(["domain", 'header_code', 'ip', 'port', 'webtitle'])
#fofa查询语法
fofasearch= "domain=\"{}\"||cert=\"{}\""

#hunter查询语法
huntersearch='domain.suffix="{}"'



#工具参数
#shuffledns
#linux
l_shuffledns="cat %s | xargs -I {} ./bin/shuffledns/shuffledns -d {} -w ./bin/shuffledns/domain.txt -r ./bin/shuffledns/resolvers.txt  >> %s/shuffledns.txt -m ./bin/massdns/massdns_linux"
#macos
m_shuffledns="cat %s | xargs -I {} ./bin/shuffledns/shuffledns_m -d {} -w ./bin/shuffledns/domain.txt -r ./bin/shuffledns/resolvers.txt  >> %s/shuffledns.txt -m ./bin/massdns/massdns_linux"


#assetfinder
#linux
l_assetfinder="cat %s | xargs -I {} ./bin/assetfinder/assetfinder {} >> %s/assetfinder.txt"
#macos
m_assetfinder="cat %s | xargs -I {} ./bin/assetfinder/assetfinder_m {} >> %s/assetfinder.txt"

webport=[8000,8080,8089,9000,9200,11211,27017,80,81,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880]

#subfinder
#linux
l_subfinder="./bin/subfinder/subfinder -dL {} -o {}/subfinder.txt"
#mac
m_subfinder="./bin/subfinder/subfinder_m -dL {} -o {}/subfinder.txt"

#端口扫描参数 预留格式化参数{} outpath
masscan="masscan -iL {}/alive_ip.txt -p 21,22,80,81,135,139,443,445,1433,1521,3306,5432,6379,7001,8000,8080,8089,9000,9200,11211,27017,82,83,84,85,86,87,88,89,90,91,92,98,99,443,800,801,808,880,888,889,1000,1010,1080,1081,1082,1099,1118,1888,2008,2020,2100,2375,2379,3000,3008,3128,3505,5555,6080,6648,6868,7000,7001,7002,7003,7004,7005,7007,7008,7070,7071,7074,7078,7080,7088,7200,7680,7687,7688,7777,7890,8000,8001,8002,8003,8004,8006,8008,8009,8010,8011,8012,8016,8018,8020,8028,8030,8038,8042,8044,8046,8048,8053,8060,8069,8070,8080,8081,8082,8083,8084,8085,8086,8087,8088,8089,8090,8091,8092,8093,8094,8095,8096,8097,8098,8099,8100,8101,8108,8118,8161,8172,8180,8181,8200,8222,8244,8258,8280,8288,8300,8360,8443,8448,8484,8800,8834,8838,8848,8858,8868,8879,8880,8881,8888,8899,8983,8989,9000,9001,9002,9008,9010,9043,9060,9080,9081,9082,9083,9084,9085,9086,9087,9088,9089,9090,9091,9092,9093,9094,9095,9096,9097,9098,9099,9100,9200,9443,9448,9800,9981,9986,9988,9998,9999,10000,10001,10002,10004,10008,10010,10250,12018,12443,14000,16080,18000,18001,18002,18004,18008,18080,18082,18088,18090,18098,19001,20000,20720,21000,21501,21502,28018,20880 --rate=1000 -oJ {}/alive_port.json"

#nmap扫描部分参数
nmap="-sV -n -Pn --open -sT -T4 --version-intensity 7"